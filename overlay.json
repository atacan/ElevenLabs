{
    "overlay": "1.0.0",
    "info": {
        "title": "Fix OpenAPI spec - Fix speech-to-text additional_formats issue",
        "version": "1.0.1"
    },
    "actions": [
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties.additional_formats",
            "remove": true
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties",
            "update": {
                "additional_formats": {
                    "type": "array",
                    "description": "A list of additional formats to export the transcript to.",
                    "items": {
                        "$ref": "#/components/schemas/ExportOptions"
                    },
                    "maxItems": 10
                }
            }
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties.file",
            "remove": true
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties",
            "update": {
                "file": {
                    "type": "string",
                    "format": "binary"
                }
            }
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties.language_code",
            "remove": true
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties",
            "update": {
                "language_code": {
                    "type": "string",
                    "title": "Language Code",
                    "description": "An ISO-639-1 or ISO-639-3 language_code corresponding to the language of the audio file. Can sometimes improve transcription performance if known beforehand. Defaults to null, in this case the language is predicted automatically."
                }
            }
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties.num_speakers",
            "remove": true
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties",
            "update": {
                "num_speakers": {
                    "type": "integer",
                    "maximum": 32,
                    "minimum": 1,
                    "title": "Num Speakers",
                    "description": "The maximum amount of speakers talking in the uploaded file. Can help with predicting who speaks when. The maximum amount of speakers that can be predicted is 32. Defaults to null, in this case the amount of speakers is set to the maximum value the model supports."
                }
            }
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties.diarization_threshold",
            "remove": true
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties",
            "update": {
                "diarization_threshold": {
                    "type": "number",
                    "maximum": 0.4,
                    "minimum": 0.1,
                    "title": "Diarization Threshold",
                    "description": "Diarization threshold to apply during speaker diarization. A higher value means there will be a lower chance of one speaker being diarized as two different speakers but also a higher chance of two different speakers being diarized as one speaker (less total speakers predicted). A low value means there will be a higher chance of one speaker being diarized as two different speakers but also a lower chance of two different speakers being diarized as one speaker (more total speakers predicted). Can only be set when diarize=True and num_speakers=None. Defaults to None, in which case we will choose a threshold based on the model_id (0.22 usually)."
                }
            }
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties.cloud_storage_url",
            "remove": true
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties",
            "update": {
                "cloud_storage_url": {
                    "type": "string",
                    "title": "Cloud Storage Url",
                    "description": "The HTTPS URL of the file to transcribe. Exactly one of the file or cloud_storage_url parameters must be provided. The file must be accessible via HTTPS and the file size must be less than 2GB. Any valid HTTPS URL is accepted, including URLs from cloud storage providers (AWS S3, Google Cloud Storage, Cloudflare R2, etc.), CDNs, or any other HTTPS source. URLs can be pre-signed or include authentication tokens in query parameters.",
                    "examples": [
                        "https://storage.googleapis.com/my-bucket/folder/audio.mp3",
                        "https://my-bucket.s3.us-west-2.amazonaws.com/folder/audio.mp3",
                        "https://account123.r2.cloudflarestorage.com/my-bucket/audio.mp3",
                        "https://cdn.example.com/media/audio.wav"
                    ]
                }
            }
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties.webhook_id",
            "remove": true
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties",
            "update": {
                "webhook_id": {
                    "type": "string",
                    "title": "Webhook Id",
                    "description": "Optional specific webhook ID to send the transcription result to. Only valid when webhook is set to true. If not provided, transcription will be sent to all configured speech-to-text webhooks."
                }
            }
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties.temperature",
            "remove": true
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties",
            "update": {
                "temperature": {
                    "type": "number",
                    "maximum": 2,
                    "minimum": 0,
                    "title": "Temperature",
                    "description": "Controls the randomness of the transcription output. Accepts values between 0.0 and 2.0, where higher values result in more diverse and less deterministic results. If omitted, we will use a temperature based on the model you selected which is usually 0."
                }
            }
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties.seed",
            "remove": true
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties",
            "update": {
                "seed": {
                    "type": "integer",
                    "maximum": 2147483647,
                    "minimum": 0,
                    "title": "Seed",
                    "description": "If specified, our system will make a best effort to sample deterministically, such that repeated requests with the same seed and parameters should return the same result. Determinism is not guaranteed. Must be an integer between 0 and 2147483647.",
                    "examples": [
                        12345
                    ]
                }
            }
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties.webhook_metadata",
            "remove": true
        },
        {
            "target": "$.components.schemas.Body_Speech_to_Text_v1_speech_to_text_post.properties",
            "update": {
                "webhook_metadata": {
                    "anyOf": [
                        {
                            "type": "string"
                        },
                        {
                            "type": "object"
                        }
                    ],
                    "title": "Webhook Metadata",
                    "description": "Optional metadata to be included in the webhook response. This should be a JSON string representing an object with a maximum depth of 2 levels and maximum size of 16KB. Useful for tracking internal IDs, job references, or other contextual information.",
                    "examples": [
                        "{\"user_id\": \"123\", \"session_id\": \"abc-def-ghi\"}",
                        "{\"request_type\": \"interview\", \"participant_name\": \"John Doe\"}"
                    ]
                }
            }
        }
    ]
}